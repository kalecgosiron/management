<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>保单查询</title>
    <meta name="renderer" content="webkit" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0"
    />
    <link
      rel="stylesheet"
      href="../../layuiadmin/layui/css/layui.css"
      media="all"
    />
    <link
      rel="stylesheet"
      href="../../layuiadmin/style/admin.css"
      media="all"
    />
  </head>
  <body>
    <div class="layui-fluid" id="form">
      <div class="layui-col-md6">
        <div class="layui-card">
          <div class="layui-card-header">保单查询</div>
          <div class="layui-card-body" style="padding: 15px;">
            <form class="layui-form" id="checkform">
              <div class="layui-form-item">
                <div class="layui-col-lg6">
                  <label class="layui-form-label">保单号</label>
                  <div class="layui-input-block">
                    <input
                      type="text"
                      name="ordernumber"
                      autocomplete="off"
                      placeholder="请输入保单号"
                      class="layui-input"
                    />
                  </div>
                </div>
                <div class="layui-col-lg6">
                  <label class="layui-form-label">出单日期</label>
                  <div class="layui-input-inline">
                    <input
                      type="text"
                      name="date"
                      class="layui-input"
                      id="test6"
                      placeholder=" - "
                    />
                  </div>
                </div>
              </div>

              <div class="layui-form-item">
                <div class="layui-col-lg6">
                  <label class="layui-form-label">保单印刷号</label>
                  <div class="layui-input-block">
                    <input
                      type="text"
                      name="orderprintnumber"
                      autocomplete="off"
                      placeholder="请输入保单印刷号"
                      class="layui-input"
                    />
                  </div>
                </div>
                <div class="layui-col-lg6">
                  <div class="layui-inline">
                    <label class="layui-form-label">归属部门</label>
                    <div class="layui-input-inline">
                      <select
                        name="attributiondepartment"
                        lay-verify="required"
                        lay-search=""
                      >
                        <option value="">直接选择或搜索选择</option>
                        <option value="44018447">44018447</option>
                        <option value="44018420">44018420</option>
                        <option value="44018446">44018446</option>
                        <option value="44018403">44018403</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>

              <div class="layui-form-item">
                <div class="layui-col-lg6">
                  <label class="layui-form-label">经办人</label>
                  <div class="layui-input-block" style="width:40%">
                    <input
                      type="text"
                      name="charge"
                      autocomplete="off"
                      placeholder="请输入经办人"
                      class="layui-input"
                    />
                  </div>
                </div>
                <div class="layui-col-lg6">
                  <label class="layui-form-label">出单员</label>
                  <div class="layui-input-block" style="width:40%">
                    <input
                      type="text"
                      name="dispatchclerk"
                      autocomplete="off"
                      placeholder="请输入出单员"
                      class="layui-input"
                    />
                  </div>
                </div>
              </div>

              <div class="layui-form-item">
                <div class="layui-col-lg6">
                  <label class="layui-form-label">被保险人</label>
                  <div class="layui-input-block" style="width:40%">
                    <input
                      type="text"
                      name="insured"
                      autocomplete="off"
                      placeholder="请输入经办人"
                      class="layui-input"
                    />
                  </div>
                </div>
                <div class="layui-col-lg6">
                  <label class="layui-form-label">投保人</label>
                  <div class="layui-input-block" style="width:40%">
                    <input
                      type="text"
                      name="applicant"
                      autocomplete="off"
                      placeholder="请输入出单员"
                      class="layui-input"
                    />
                  </div>
                </div>
              </div>

              <div class="layui-form-item">
                <div class="layui-col-lg6">
                  <label class="layui-form-label">投保单签章</label>
                  <div class="layui-input-block">
                    <input
                      type="radio"
                      name="ordersignature"
                      value="欠缺"
                      title="欠投保资料"
                      checked=""
                    />
                    <input
                      type="radio"
                      name="ordersignature"
                      value="不欠缺"
                      title="不欠投保资料"
                    />
                  </div>
                </div>
                <div class="layui-col-lg6">
                  <label class="layui-form-label">保单类型</label>
                  <div class="layui-input-block">
                    <input
                      type="radio"
                      name="ordertype"
                      value="车险"
                      title="车险"
                      checked=""
                    />
                    <input
                      type="radio"
                      name="ordertype"
                      value="非车险"
                      title="非车险"
                    />
                  </div>
                </div>
              </div>
              <div class="layui-form-item">
                <div class="layui-input-block" style="margin-left: 300px;">
                  <button class="layui-btn" type="button" id="checkformsubmit">
                    立即提交
                  </button>
                  <button type="reset" class="layui-btn layui-btn-primary">
                    重置
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <script src="../../layuiadmin/layui/layui.js"></script>
    <script>
      layui
        .config({
          base: '../../layuiadmin/' //静态资源所在路径
        })
        .extend({
          index: 'lib/index' //主入口模块
        })
        .use(['index', 'form', 'laydate'], function() {
          var $ = layui.$,
            admin = layui.admin,
            element = layui.element,
            layer = layui.layer,
            laydate = layui.laydate,
            form = layui.form

          //日期范围
          laydate.render({
            elem: '#test6',
            range: true
          })

          form.render(null, 'component-form-group')

          laydate.render({
            elem: '#LAY-component-form-group-date'
          })

          //提交按钮
          $('#checkformsubmit').click(function() {
            $.ajax({
              headers: {
                Authorization: window.localStorage.getItem('token')
              },
              data: $('#checkform').serialize(),
              type: 'POST', //提交的方法
              url: 'http://localhost:3000/check/checkOrder', //提交的地址
              async: false,
              success: function(data) {
                console.log(data)
                if (data.code == 200) {
                  $('#form').hide()
                  if (data.type == '车险') {
                    var tableData =
                      "<div class='layui-fluid'><div class='layui-col-md12'><div class='layui-card'><table class='layui-table' id='tableID'><thead><tr>"
                    tableData +=
                      '<th>保单号</th><th>被保险人</th><th>车牌</th><th>投保单签章</th><th>经办人</th><th>出单日期</th><th>出单员</th><th>保单印刷号</th><th>业务归属部门</th><th>保单状态</th><th>创建时间</th><th>创建用户</th></thead><tbody>'
                    $.each(data.results, function(key, value) {
                      console.log(key)
                      console.log(value)
                      tableData +=
                        '<tr>' +
                        '<td>' +
                        value.ordernumber +
                        '</td>' +
                        '<td>' +
                        value.insured +
                        '</td>' +
                        '<td>' +
                        value.licenseplate +
                        '</td>' +
                        '<td>' +
                        value.ordersignature +
                        '</td>' +
                        '<td>' +
                        value.charge +
                        '</td>' +
                        '<td>' +
                        value.date +
                        '</td>' +
                        '<td>' +
                        value.dispatchclerk +
                        '</td>' +
                        '<td>' +
                        value.orderprintnumber +
                        '</td>' +
                        '<td>' +
                        value.attributiondepartment +
                        '</td>' +
                        '<td>' +
                        value.state +
                        '</td>' +
                        '<td>' +
                        value.createtime +
                        '</td>' +
                        '<td>' +
                        value.createuser +
                        '</td>' +
                        '</tr>'
                    })
                    console.log(tableData)
                    tableData += '</tbody></table></div></div></div>'
                    $('body').append(tableData)
                  } else if (data.type == '非车险') {
                    var tableData =
                      "<div class='layui-fluid'><div class='layui-col-md12'><div class='layui-card'><table class='layui-table' id='tableID'><thead><tr>"
                    tableData +=
                      '<th>保单号</th><th>投保人名称</th><th>投保单签章</th><th>经办人</th><th>出单日期</th><th>出单员</th><th>保单印刷号</th><th>业务归属部门</th><th>保单状态</th><th>创建时间</th><th>创建用户</th></thead><tbody>'
                    $.each(data.results, function(key, value) {
                      console.log(key)
                      console.log(value)
                      tableData +=
                        '<tr>' +
                        '<td>' +
                        value.ordernumber +
                        '</td>' +
                        '<td>' +
                        value.applicant +
                        '</td>' +
                        '<td>' +
                        value.ordersignature +
                        '</td>' +
                        '<td>' +
                        value.charge +
                        '</td>' +
                        '<td>' +
                        value.date +
                        '</td>' +
                        '<td>' +
                        value.dispatchclerk +
                        '</td>' +
                        '<td>' +
                        value.orderprintnumber +
                        '</td>' +
                        '<td>' +
                        value.attributiondepartment +
                        '</td>' +
                        '<td>' +
                        value.state +
                        '</td>' +
                        '<td>' +
                        value.createtime +
                        '</td>' +
                        '<td>' +
                        value.createuser +
                        '</td>' +
                        '</tr>'
                    })
                    console.log(tableData)
                    tableData += '</tbody></table></div></div></div>'
                    $('body').append(tableData)
                  }
                } else if (data.code == 404) {
                  alert('查不到相关信息')
                }
              },
              error: function(request) {
                //失败的话
                alert('连接错误')
              }
            })
          })
        })
    </script>
  </body>
</html>
